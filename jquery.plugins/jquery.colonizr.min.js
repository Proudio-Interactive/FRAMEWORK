/* =============================================================
 *
 * jQuery colonizr V0.9.6 - Molokoloco 2013 - Copyleft
 * "In-between titles Multicols paragraphes" (Bootstrap-like plugin)
 *
 * Blog post : http://www.b2bweb.fr/molokoloco/jquery-colonize-plugin-in-between-titles-multicols-paragraphes-with-css3/
 * Live fiddle demo : http://jsfiddle.net/molokoloco/Ra288/
 * Github :
 *   - https://github.com/molokoloco/FRAMEWORK/blob/master/jquery.plugins/jquery.colonizr.js
 *   - https://github.com/molokoloco/FRAMEWORK/blob/master/jquery.plugins/jquery.colonizr.min.js
 *   - https://github.com/molokoloco/FRAMEWORK/blob/master/jquery.plugins/jquery.colonizr.css
 *
 * ============================================================== */

!function($){function Colonizr(element,options){this.options=$.extend(true,{},$.fn.colonizr.defaults,typeof options=="object"&&options||{});this.$container=$(element);this.wrapper='<div class="'+this.options.css+'"/>';this.cWidth,this.intentNextP,this.lineMinHeight,this.maxHeight;this.refresh()}Colonizr.prototype={constructor:Colonizr,colsExtractor:function(i,e){var $element=$(e),$next=$element.next(),$collection=[],jumpNext=false,totalHeight=0,estimateHeight=0;while($next)if($next.is(this.options.chapters))$next=
null;else if($next.is(this.options.take)){$collection.push($next);$next=$next.next()}else{if($next.length)$element=$next;$next=$next.next();if($next.length)jumpNext=true;$next=null}if($collection.length)for(var j=0,len=$collection.length;j<len;j++)estimateHeight+=$collection[j].outerHeight();if($collection.length&&estimateHeight>this.lineMinHeight){var $wrapper=$(this.wrapper);for(var j=0,len=$collection.length;j<len;j++){if(totalHeight==0&&$collection[j].html()=="&nbsp;")continue;totalHeight+=$collection[j].outerHeight();
$wrapper.append($collection[j].detach());if($collection[j+1]&&this.maxHeight<=totalHeight+$collection[j+1].outerHeight()){$wrapper.insertAfter($element);$element=$wrapper;totalHeight=0;$wrapper=$(this.wrapper)}}$wrapper.insertAfter($element)}if(jumpNext)this.colsExtractor(0,$element.next())},refresh:function(){this.cWidth=this.$container.width();this.maxHeight=this.options.maxHeight;this.intentNextP=0;this.lineMinHeight=0;if(this.options.maxHeight<1)this.maxHeight=Math.max(80,$(window).height()*0.8);
var $p=$("<p>A</p>").appendTo(this.$container);this.lineMinHeight=$p.outerHeight()*this.options.minLine;$p.remove();var $exists=this.$container.find("."+this.options.css);if($exists.length){var exists="",$prev=this.$container.prev();this.$container.detach();$exists.each(function(){var $this=$(this);$($this.html()).insertBefore($this);$this.remove()});this.$container.insertAfter($prev)}var that=this;this.$container.find(this.options.chapters).each(function(i,e){setTimeout($.proxy(that.colsExtractor,
that),0,i,e)})}};var old=$.fn.colonizr;$.fn.colonizr=function(options){return this.each(function(){var $this=$(this),data=$this.data("colonizr");if(!data)$this.data("colonizr",data=new Colonizr(this,options));if(typeof options=="string")data[options]()})};$.fn.colonizr.Constructor=Colonizr;$.fn.colonizr.defaults={chapters:"h1,h2,h3,h4,h5,h6",take:"p",css:"multiplecolumns",minLine:2,maxHeight:null};$.fn.colonizr.noConflict=function(){$.fn.colonizr=old;return this};$(window).on("load",function(){$('[data-colonizr="true"]').each(function(){var $spy=
$(this);$spy.colonizr($spy.data())})})}(window.jQuery);