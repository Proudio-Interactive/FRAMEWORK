/* =============================================================
 *
 * jQuery colonizr V0.9.7 - Molokoloco 2013 - Copyleft
 * "In-between titles Multicols paragraphes" (Bootstrap-like plugin)
 *
 * Blog post : http://www.b2bweb.fr/molokoloco/jquery-colonize-plugin-in-between-titles-multicols-paragraphes-with-css3/
 * Live fiddle demo : http://jsfiddle.net/molokoloco/Ra288/
 * Github :
 *   - https://github.com/molokoloco/FRAMEWORK/blob/master/jquery.plugins/jquery.colonizr.js
 *   - https://github.com/molokoloco/FRAMEWORK/blob/master/jquery.plugins/jquery.colonizr.min.js
 *   - https://github.com/molokoloco/FRAMEWORK/blob/master/jquery.plugins/jquery.colonizr.css
 *
 * ============================================================== */

(function(d){function g(a,e){this.options=d.extend(!0,{},d.fn.colonizr.defaults,"object"==typeof e&&e||{});this.$container=d(a);this.wrapper='<div class="'+this.options.css+'"/>';this.cWidth;this.intentNextP;this.lineMinHeight;this.maxHeight;this.chaptersTotal;this.refresh()}g.prototype={constructor:g,colsExtractor:function(a,e){for(var c=e.next(),f=[],l=!1,k=0,h=0;c.length;)if(c.is(this.options.take))f.push(c),c=c.next();else{if(!c.is(this.options.chapters)){var l=!0,b=c.next();b.length&&(!b.is(this.options.take)&&
b.is(this.options.chapters))&&(e=c,c=b)}break}if(f.length)for(var b=0,g=f.length;b<g;b++)h+=f[b].data("h");if(f.length&&h>this.lineMinHeight){h=d(this.wrapper);b=0;for(g=f.length;b<g;b++)1>k&&("&nbsp;"==f[b].html()||f[b].is("br"))?f[b].detach():(k+=f[b].data("h"),h.append(f[b].detach()),f[b+1]&&k+f[b+1].data("h")>=this.maxHeight&&(h.insertAfter(e),e=h,k=0,h=d(this.wrapper)));h.insertAfter(e)}l?this.colsExtractor(a,c):a+1==this.chaptersTotal&&this.$container.trigger("finish")},cleanColumns:function(){var a=
this.$container.find("."+this.options.css);if(a.length){var e=this.$container.parent(),c=this.$container.prev();this.$container.detach();a.each(function(){var a=d(this);d(a.html()).insertBefore(a);a.remove()});c.length?this.$container.insertAfter(c):this.$container.appendTo(e)}},refresh:function(){this.cleanColumns();var a=this,e=a.$container.find(a.options.chapters),c=a.$container.parent(),f=a.$container.prev();a.chaptersTotal=e.length;a.cWidth=a.$container.width();a.maxHeight=a.options.maxHeight;
a.intentNextP=0;a.lineMinHeight=0;1>a.options.maxHeight&&(a.maxHeight=Math.max(80,0.8*d(window).height()));var g=d("<p>A</p>").appendTo(a.$container);a.lineMinHeight=g.outerHeight()*a.options.minLine;g.remove();a.$container.on("finish",function(){f.length?a.$container.insertAfter(f):a.$container.appendTo(c)});e.each(function(c,e){for(var b=d(e).next();b.length;)b.is(a.options.chapters)?b=[]:(b.length&&b.is(a.options.take)&&b.data("h",b.outerHeight()),b.length&&(b=b.next()))});a.$container=a.$container.detach();
e.each(function(c,e){a.colsExtractor(c,d(e))})}};var m=d.fn.colonizr;d.fn.colonizr=function(a){return this.each(function(){var e=d(this),c=e.data("colonizr");c||e.data("colonizr",c=new g(this,a));if("string"==typeof a)c[a]()})};d.fn.colonizr.Constructor=g;d.fn.colonizr.defaults={chapters:"h1,h2,h3,h4,h5,h6",take:"p,br",css:"multiplecolumns",minLine:2,maxHeight:null};d.fn.colonizr.noConflict=function(){d.fn.colonizr=m;return this};d(window).on("load",function(){d('[data-colonizr="true"]').each(function(){var a=
d(this);a.colonizr(a.data())})})})(window.jQuery);